---
layout: photo
title: 位运算
date: 2022-06-30 00:52:34
tags: 位运算
---

# 位运算

### 前言

计算机的加减操作转到计算机底层就是二进制的位操作，这么做的目的是为了更符合人类十进制的操作习惯。所以我们直接操作二进制进行位运算要比十进制的加减乘除性能更好。

### 案例

除了在计算方面更加高效，在存储数据时也更加节省空间。比如bitmap（位图），如果此时有一个需求要存储八部手机的‘合格’与‘不合格’两种状态，如果我们采用面向对象存储时，创建一个手机对象，其属性有bool =true/false true=合格 false=不合格，一个手机对象就需要用16个字节来存储。此时我们如果用8个比特位来存储 1000 0001 那么此时1和8号手机代表合格其他代表不合格，此时我们只用了一个字节就存储了8个手机的信息，存储空间优化了128倍。

### 基础

位运算操作符

- & ，1&1=1，只有两个数都为1时才会得1其他都得0
- ｜，0&0=0，只有两个数都为0时才会得0其他都得1
- ～，～0000 0001=1111 1110，取反（这里有8位因为计算机ascll码为8比特位存储，所以取反结果是这个）
- ^，0^1=1，两个数不同为1相同为0
- `>>` 1`>>`2=0;  1二进制为0000 0001 右移2位得 000 00000(01)  01被挤掉了所以等于0
- `<<` 1`<<`2=4,  0000 0001左移后结果为 0000 0100 = 4

### 位运算的一些应用

#### 搜索二进制数的第n位置是否为1

```js
/**
 * 搜索一个数的二进制数，某个位置是否为1
 * 1&1=1 两个数都为1才能1，其他情况全部为0
 * @param num 十进制数
 * @param index 搜索的位置
 * @returns {boolean} 1为true 0false
 */
function findIndexAnd(num, index) {
    // 01111010 = 122
    //    &
    // 00001000 = 8   8 = 1<<3
    // 00001000
    const temp = num & (1 << index);
    return temp === (1 << index);
}
```

#### 将二进制数的第n位置设置为1

```js
/**
 * 将一个数的二进制第n位置设置为1
 * 0|0=0 总结 两个数都为零才能得0 其他情况全部为1
 * @param num
 * @param index
 * @return {string} 二进制结果
 */
function setOneIndexOr(num, index) {
    // 01111010 = 122
    //    ｜
    // 00000100 = 4   4 = 1<<2
    // 01111110 = 126
    const temp=num|(1<<index);
    return temp.toString(2)
}
```

#### 将二进制数的第n位置设置为0

```js
/**
 * 将一个二进制数的第n位设置为零
 * ～0000 0010 = 1111 1101 总结取反
 * @param num
 * @param index
 * @return {string} 二进制结果
 */
function setZeroIndexAnd(num, index) {
    // 01111010 = 122
    //    &
    // 11111101 =  ~00000010 = ~2 = 1<<1
    // 01111000 = 120
    const temp = num & ~(1 << index);
    return temp.toString(2);
}
```

#### 将二进制数的第n位置如果是0就设置为 如果是1就设置为0

```js
/**
 * 将一个二进制数的第n位设置为零或一
 * ^ 0^1=1 总结：两个数不同得1，相同得0
 * @param num
 * @param index
 * @return {string} 二进制结果
 */
function setZeroOrOneIndex(num, index) {
    // 01111010 = 122                       01111010 = 122
    //    ^                                     ^
    // 00000010 =    2 = 1<<1               00000100 = 4 = 1<<2
    // 01111000 = 120                       01111110
    const temp = num ^ (1 << index);
    return temp.toString(2);
}
```

#### 从右至左第一个1的右边全部设置为1

```js
/**
 * 从右至左 第一个1的右边全部变为1
 * @param num
 * @return {string} 二进制结果
 */
function setR2Lto1(num) {
    // 01111010 = 122
    //    |
    // 01111001 = 122-1
    // 01111011 = 123
    const temp = num | (num - 1);
    return temp.toString(2)
}
```

#### 从右至左的第一个0变为1

```js
/**
 * 从右至左 第一个0变为1
 * @param num
 * @return {string} 二进制结果
 */
function setRZeroTo1(num) {
    // 01111010 = 122
    //    |
    // 01111011 = 122+1
    // 01111011 = 123
    const temp = num | (num + 1);
    return temp.toString(2)
}
```